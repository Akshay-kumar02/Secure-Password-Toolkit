import argparse
import itertools
import re
import zxcvbn
from datetime import datetime

def leetspeak(word):
    mapping = str.maketrans("aAeEiIoOsStT", "443311005577")
    return word.translate(mapping)

def generate_variations(words):
    variations = set()
    years = [str(y) for y in range(datetime.now().year - 30, datetime.now().year + 6)]
    specials = ["!", "@", "#", "$", "%", "&", "*"]
    numbers = [str(n) for n in range(0, 1000)]

    for w in words:
        basics = [w, w.lower(), w.upper(), w.capitalize(), leetspeak(w)]
        for base in basics:
            variations.add(base)
            for s in specials:
                variations.add(f"{base}{s}")
                variations.add(f"{s}{base}")
            for n in numbers:
                variations.add(f"{base}{n}")
            for y in years:
                variations.add(f"{base}{y}")
    return variations

def analyze_password(password):
    result = zxcvbn.zxcvbn(password)
    print(f"\nPassword: {password}")
    print(f"Score: {result['score']} / 4")
    print(f"Crack Time (Online): {result['crack_times_display']['online_no_throttling_10_per_second']}")
    print(f"Entropy: {result['entropy']:.2f} bits\n")

def main():
    parser = argparse.ArgumentParser(description="Secure Password Toolkit CLI")
    parser.add_argument("--password", help="Password to analyze")
    parser.add_argument("--inputs", nargs="*", help="Custom words for wordlist (e.g. name, pet, date)")
    parser.add_argument("--export", help="Export file name (e.g. wordlist.txt)", default="wordlist.txt")
    args = parser.parse_args()

    if args.password:
        analyze_password(args.password)

    if args.inputs:
        print("\n[+] Generating custom wordlist...")
        words = [re.sub(r'\W+', '', w) for w in args.inputs]
        wordlist = generate_variations(words)
        with open(args.export, "w") as f:
            f.write("\n".join(wordlist))
        print(f"[âœ”] Wordlist generated: {args.export} ({len(wordlist)} entries)")

if __name__ == "__main__":
    main()


###src/lib/utils.ts

export function calculateEntropy(password: string): number {
  const charset = new Set(password).size;
  return Math.round(password.length * Math.log2(charset || 1));
}

export function estimateCrackTime(entropy: number): string {
  const guessesPerSecond = 1e9; // billion guesses/sec
  const seconds = Math.pow(2, entropy) / guessesPerSecond;
  const minutes = seconds / 60;
  const hours = minutes / 60;
  const days = hours / 24;
  if (days > 365) return `${(days / 365).toFixed(1)} years`;
  if (hours > 24) return `${days.toFixed(1)} days`;
  if (minutes > 60) return `${hours.toFixed(1)} hours`;
  return `${minutes.toFixed(1)} minutes`;
}




#####src/components/PasswordAnalyzer.tsx


import React, { useState } from "react";
import { calculateEntropy, estimateCrackTime } from "../lib/utils";

const PasswordAnalyzer: React.FC = () => {
  const [password, setPassword] = useState("");
  const entropy = calculateEntropy(password);
  const strength =
    entropy < 30 ? "Weak" :
    entropy < 50 ? "Fair" :
    entropy < 70 ? "Good" :
    entropy < 90 ? "Strong" : "Very Strong";

  return (
    <div className="p-4 bg-white dark:bg-gray-900 rounded-2xl shadow">
      <h2 className="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-200">Password Strength Analyzer</h2>
      <input
        type="password"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
        placeholder="Enter your password..."
        className="w-full p-2 border rounded mb-3"
      />
      {password && (
        <div className="text-sm text-gray-700 dark:text-gray-300">
          <p>Entropy: {entropy} bits</p>
          <p>Strength: <strong>{strength}</strong></p>
          <p>Estimated crack time: {estimateCrackTime(entropy)}</p>
        </div>
      )}
    </div>
  );
};

export default PasswordAnalyzer;

